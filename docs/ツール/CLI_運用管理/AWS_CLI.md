# AWS CLI

## 概要

AWS CLI は AWS リソースをコマンドラインで操作する公式ツールである。インフラ構築、日常運用、自動化スクリプト、CI/CD 実行に幅広く利用できる。

## 料金

| 区分 | 内容 |
|------|------|
| AWS CLI 本体 | 無料 |
| AWS 利用料 | 操作対象の AWS リソース利用分に課金 |

## 主な特徴

| 項目 | 内容 |
|------|------|
| 公式ツール | AWS API との互換性が高い |
| 自動化向き | シェル・CI に組み込みやすい |
| クロスプラットフォーム | Windows/macOS/Linux に対応 |
| サービス網羅 | 主要 AWS サービスを一貫操作 |
| 出力制御 | `json`/`table`/`text` で整形可能 |

## 主な機能

### リソース操作

| 機能 | 説明 |
|------|------|
| 作成/更新/削除 | EC2、S3、IAM、RDS などを管理 |
| 一覧/検索 | リソース情報を取得 |
| デプロイ補助 | CloudFormation 実行や状態確認 |
| クエリ抽出 | JMESPath で必要項目のみ取得 |

### 認証・権限

| 機能 | 説明 |
|------|------|
| プロファイル管理 | 複数アカウントを切り替え運用 |
| MFA/SSO 連携 | 組織運用の認証方式に対応 |
| 権限適用 | IAM ポリシーの影響を確認しやすい |
| リージョン制御 | 実行リージョンを明示指定可能 |

### 運用支援

| 機能 | 説明 |
|------|------|
| 非対話実行 | 自動ジョブで実行可能 |
| 返り値活用 | JSON 出力を次工程へ連携 |
| Dry-run 系確認 | 一部操作で事前検証が可能 |
| 監査補助 | 実行履歴を運用ログに残しやすい |

## インストールとセットアップ

公式URL:
- [AWS CLI 公式](https://aws.amazon.com/cli/)
- [インストール手順](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html)

セットアップ手順:
1. OS に合わせて AWS CLI v2 をインストールする。
2. `aws configure` または SSO で認証情報を設定する。
3. プロファイル、リージョン、出力形式をチーム標準で統一する。

## 基本的な使い方

1. 実行前に対象アカウント・リージョンを確認する。
2. 一覧系コマンドで現状を把握してから変更系を実行する。
3. 重要操作はスクリプト化し、レビューを通して実行する。
4. 実行ログを保存して監査可能な状態を維持する。

最小コマンド:
- バージョン確認: `aws --version`
- 認証設定: `aws configure`
- 呼び出し元確認: `aws sts get-caller-identity`

## メリット

- AWS 操作を標準化しやすい
- GUI より高速に一括操作しやすい
- スクリプト化で再現性を確保しやすい
- IaC と組み合わせた運用に適している

## デメリット

- コマンド習熟が必要
- 権限誤設定や誤操作時の影響が大きい
- 複数アカウント運用では設定管理が複雑化しやすい

## 他ツールとの比較

| ツール | 主な用途 | 特徴 |
|------|------|------|
| AWS CLI | AWS 運用/自動化 | 公式・軽量・スクリプト向き |
| AWS Management Console | 手動操作 | GUI で確認しやすい |
| AWS CloudShell | CLI 実行環境 | ブラウザ上で即利用可能 |
| Terraform | IaC | マルチクラウド管理に強い |

## ベストプラクティス

### 1. 認証運用を分離

- 人手操作と CI 実行で IAM ロールを分ける
- 長期キー利用を避ける方針を徹底する

### 2. 実行前確認を標準化

- `sts get-caller-identity` でアカウント確認する
- リージョン指定を明示して誤操作を防ぐ

### 3. 自動化と監査を両立

- 重要操作はスクリプト化してレビューする
- 実行ログを保存し、追跡可能にする

## 公式ドキュメント

- 公式: https://aws.amazon.com/cli/
- インストール: https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html
- ユーザーガイド: https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-welcome.html

## まとめ

1. ** 基盤力 ** : AWS CLI は AWS 運用と自動化の基盤として有効。
2. ** 安全性 ** : 認証分離と事前確認の徹底で安全性が向上する。
3. ** 再現性 ** : スクリプト化とログ保存で再現性と監査性を確保できる。
