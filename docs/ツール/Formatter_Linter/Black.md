# Black

## 概要

Black は Python コードフォーマッタである。ルールを最小化した一貫フォーマットにより、コードスタイル議論を減らし、レビュー効率を高められる。

## 料金

| 区分 | 内容 |
|------|------|
| Black 本体 | 無料（OSS） |
| 補足 | 実行環境（CI など）のコストは別途 |

## 主な特徴

| 項目 | 内容 |
|------|------|
| Opinionated | 強い規約で統一フォーマットを適用 |
| 高速 | 大規模コードでも実行しやすい |
| 差分削減 | 不要な整形差分を減らせる |
| 連携容易 | pre-commit/CI に組み込みやすい |
| 互換性 | 主要 Python バージョンをサポート |

## 主な機能

### 整形機能

| 機能 | 説明 |
|------|------|
| 自動フォーマット | ファイル単位・ディレクトリ単位で整形 |
| チェックモード | 変更せず不整形を検知 |
| 対象制御 | include/exclude で適用範囲を設定 |
| 行長設定 | 既定値またはプロジェクト規約に合わせる |

### 運用機能

| 機能 | 説明 |
|------|------|
| pyproject 管理 | 設定を一元化 |
| pre-commit 連携 | コミット前に自動整形 |
| CI 検証 | スタイル逸脱を自動検知 |
| 他ツール共存 | Ruff/isort などと併用可能 |

### 品質支援

| 機能 | 説明 |
|------|------|
| レビュー効率化 | 見た目差分を減らしロジック確認に集中 |
| 規約統一 | チームで同じ整形を再現 |
| 導入容易 | 最小設定で開始可能 |
| 保守性向上 | コードの読みやすさを維持しやすい |

## インストールとセットアップ

公式URL:
- [Black 公式](https://black.readthedocs.io/)
- [Black GitHub](https://github.com/psf/black)

セットアップ手順:
1. 開発依存に Black を追加する。
2. `pyproject.toml` に行長など最小設定を定義する。
3. pre-commit または CI で整形チェックを有効化する。

## 基本的な使い方

1. 初回はリポジトリ全体を整形して基準を揃える。
2. 日常開発では保存時整形またはコミット前整形を利用する。
3. CI ではチェックモードを使い、未整形コードをブロックする。
4. 例外的な除外は最小限に留める。

最小コマンド:
- 整形: `black .`
- 検証: `black --check .`

## メリット

- スタイル議論を削減できる
- コードレビューの効率が上がる
- チーム全体で整形結果を統一できる
- 導入コストが低い

## デメリット

- 細かなスタイル調整はしにくい
- 既存コード導入時に差分が大量発生する
- 複数整形ツール併用時は順序設計が必要

## 他ツールとの比較

| ツール | 主な用途 | 特徴 |
|------|------|------|
| Black | Python 整形 | 設定少なめで強制統一 |
| Ruff format | Python 整形 | lint と統合しやすい |
| autopep8 | Python 整形 | PEP8 修正中心 |
| yapf | Python 整形 | カスタマイズ性が高い |

## ベストプラクティス

### 1. 一括導入タイミングを決める

- 影響の少ないタイミングで全体整形する
- 整形専用コミットを分離する

### 2. 設定を固定する

- `pyproject.toml` で全員同じ設定を使う
- バージョンを固定して差分揺れを防ぐ

### 3. 自動化で徹底する

- pre-commit と CI の両方でチェックする
- 手動整形運用に依存しない

## 公式ドキュメント

- 公式: https://black.readthedocs.io/
- GitHub: https://github.com/psf/black
- PyPI: https://pypi.org/project/black/

## まとめ

1. ** 標準化 ** : Black は Python コード整形の標準化に有効。
2. ** 自動化 ** : pre-commit/CI と組み合わせると運用が安定する。
3. ** 計画性 ** : 初回導入時の差分管理ルールを先に決めるのが重要。
