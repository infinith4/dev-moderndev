# Chaos Mesh

## 概要

Chaos Mesh は Kubernetes 向けのカオスエンジニアリングツールである。障害注入を計画的に実施し、システムの耐障害性と復旧手順の有効性を検証できる。

## 料金

| プラン | 内容 |
|------|------|
| OSS 版 | 無料（Apache License 2.0） |
| 補足 | クラスタ・監視基盤の運用コストは別途発生 |

## 主な特徴

| 項目 | 内容 |
|------|------|
| Kubernetes ネイティブ | CRD ベースで障害シナリオを管理 |
| 多様な障害注入 | Pod、Network、IO、Stress などに対応 |
| 実験管理 | スケジュール実行と停止制御が可能 |
| 可視化 | 実験状況を UI で把握しやすい |
| 安全制御 | 対象範囲を限定して段階導入可能 |

## 主な機能

### 障害注入機能

| 機能 | 説明 |
|------|------|
| PodChaos | Pod 停止・再起動・kill を注入 |
| NetworkChaos | 遅延、パケットロス、分断を再現 |
| StressChaos | CPU/メモリ負荷を注入 |
| IOChaos | ディスク遅延やエラーを再現 |

### 実験管理機能

| 機能 | 説明 |
|------|------|
| Workflow | 複数実験を順序制御 |
| Schedule | 定期実験を自動化 |
| Scope 制御 | Namespace/Label で対象を限定 |
| 一時停止/停止 | 実験中の安全停止に対応 |

### 運用機能

| 機能 | 説明 |
|------|------|
| ダッシュボード | 実験状態を可視化 |
| 監視連携 | Prometheus/Grafana と連携しやすい |
| 監査性 | 実験定義を Git 管理しやすい |
| 復旧訓練 | 障害対応手順の実地検証に有効 |

## インストールとセットアップ

公式URL:
- [Chaos Mesh 公式](https://chaos-mesh.org/)
- [Chaos Mesh Docs](https://chaos-mesh.org/docs/)
- [Chaos Mesh GitHub](https://github.com/chaos-mesh/chaos-mesh)

セットアップの要点:
1. 対象クラスタに Chaos Mesh を導入する。
2. 実験対象 namespace と安全範囲を定義する。
3. 監視アラートとロールバック手順を先に準備する。

## 基本的な使い方

1. 影響の小さいサービスから実験を開始する。
2. まず単一障害（例: Pod 停止）を短時間で実施する。
3. 監視指標と復旧時間を記録する。
4. 実験結果をもとに運用手順や設定を改善する。

最小コマンド:
- Helm インストール例: `helm install chaos-mesh chaos-mesh/chaos-mesh -n chaos-mesh --create-namespace`

## メリット

- 障害耐性を実環境に近い形で検証できる
- 復旧手順の実効性を確認できる
- 障害時のボトルネックを早期発見しやすい
- SRE 運用の成熟度向上に寄与する

## デメリット

- 実験設計を誤ると影響範囲が大きくなる
- 監視・ロールバック準備が必須
- 組織的な運用ルールなしでは継続しづらい

## 他ツールとの比較

| ツール | 主な対象 | 特徴 |
|------|------|------|
| Chaos Mesh | Kubernetes カオス実験 | K8s ネイティブで実験管理しやすい |
| Litmus | Kubernetes カオス実験 | 実験テンプレートと運用機能が豊富 |
| Gremlin | カオス実験（商用） | 管理機能とサポートが充実 |
| k6 | 負荷試験 | 障害注入ではなく性能試験向け |

## ベストプラクティス

### 1. 小さく始める

- 低リスク対象で短時間実験から開始する
- 1実験1目的で評価する

### 2. 観測指標を固定

- SLO とアラートを事前に定義する
- MTTR など復旧指標を記録する

### 3. 実験後の改善を必須化

- 結果を運用手順へ反映する
- 未対応事項を次回実験へ繋げる

## 公式ドキュメント

- 公式サイト: https://chaos-mesh.org/
- ドキュメント: https://chaos-mesh.org/docs/
- GitHub: https://github.com/chaos-mesh/chaos-mesh

## まとめ

Chaos Mesh は Kubernetes 環境の復旧性を継続的に高めるための実験基盤である。SRE 文脈で障害訓練を仕組み化したいチームに適している。
