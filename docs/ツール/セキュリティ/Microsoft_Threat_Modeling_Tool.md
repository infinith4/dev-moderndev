# Microsoft Threat Modeling Tool

## 概要

Microsoft Threat Modeling Tool（TMT）は、設計段階で脅威を洗い出すための脅威モデリングツールである。データフロー図（DFD）を作成すると、STRIDE（Spoofing、Tampering、Repudiation、Information Disclosure、Denial of Service、Elevation of Privilege）に基づいて脅威候補を自動抽出できる。

## 料金

| プラン | 内容 |
|------|------|
| Microsoft Threat Modeling Tool | 無料（Windows向け） |
| 商用利用 | 利用規約の範囲で可能（組織ポリシー確認は必要） |

## 主な特徴

| 項目 | 内容 |
|------|------|
| STRIDE ベース分析 | 体系的な脅威分類で漏れを減らしやすい |
| DFD 駆動 | アーキテクチャ図から脅威候補を生成 |
| 対策検討支援 | 脅威ごとの緩和策を整理しやすい |
| レポート出力 | 設計レビュー用に結果を共有しやすい |
| SDL 親和性 | セキュア開発プロセスへ組み込みやすい |
| Azure シナリオ対応 | クラウド構成の脅威整理に活用しやすい |

## 主な機能

### モデリング機能

| 機能 | 説明 |
|------|------|
| DFD 作成 | 外部エンティティ、プロセス、データストアを図式化 |
| データフロー定義 | コンポーネント間通信を明示 |
| トラストバウンダリ | 信頼境界を設定して分析精度を向上 |
| テンプレート利用 | システム種別に応じた初期モデルを利用 |

### 脅威分析機能

| 機能 | 説明 |
|------|------|
| STRIDE 分析 | 6分類で脅威候補を抽出 |
| 優先度管理 | 高・中・低などで対応順を整理 |
| ステータス管理 | 未対応/調査中/対策済みを追跡 |
| 根拠記録 | 対策理由や例外理由を記録 |

### レポート・レビュー機能

| 機能 | 説明 |
|------|------|
| レポート出力 | 分析結果をレビュー用資料に変換 |
| 変更追跡 | モデル更新ごとの差分を確認しやすい |
| 監査証跡 | 対応履歴を残して監査に備える |
| 共有運用 | 開発・セキュリティ間の認識合わせを支援 |

## インストールとセットアップ

公式URL:
- [ダウンロード](https://aka.ms/threatmodelingtool)
- [ドキュメント](https://learn.microsoft.com/azure/security/develop/threat-modeling-tool)
- [GitHub](https://github.com/microsoft/threat-modeling-tool)
- [Microsoft SDL](https://www.microsoft.com/securityengineering/sdl)

セットアップの要点:
1. Windows 環境に TMT を導入する。
2. 対象システムのアーキテクチャ情報（構成図、通信経路）を準備する。
3. DFD の粒度（システム全体/サブシステム単位）を決める。
4. 分析結果のレビュー担当と対応ルールを定義する。

## 基本的な使い方

1. 新規モデルを作成し、外部エンティティ・プロセス・データストアを配置する。
2. データフローとトラストバウンダリを定義する。
3. 分析ビューで自動抽出された脅威を確認する。
4. 優先度と対策方針を記録し、対応ステータスを更新する。
5. レポートを出力し、設計レビューと実装計画に反映する。

最小運用例:
- 対象: Web アプリ + API + DB 構成
- 出力: STRIDE 脅威一覧、優先度付き対策リスト

## メリット

- 設計段階で脅威を可視化し、後工程の修正コストを下げやすい。
- STRIDE で観点を統一でき、レビュー品質を揃えやすい。
- 無料で始めやすく、セキュリティ教育にも活用しやすい。

## デメリット

- Windows 専用のため、開発環境によっては運用制約がある。
- 大規模システムではモデル分割と管理ルールが必要。
- 自動抽出結果をそのまま採用せず、レビュー工数が必要。

## 他ツールとの比較

| ツール | 主な対象 | 特徴 |
|------|------|------|
| Microsoft TMT | 設計段階の脅威分析 | STRIDE と DFD で体系的に整理しやすい |
| OWASP Threat Dragon | OSS 脅威モデリング | クロスプラットフォームで扱いやすい |
| IriusRisk | エンタープライズ運用 | 自動化・ワークフロー連携が強い |
| Microsoft Threat Modeling（手法） | フレームワーク | ツール非依存で設計プロセスに組み込み可能 |

## ベストプラクティス

### 1. モデル粒度を揃える

- 1モデルの対象範囲を明確に定義する。
- サブシステムごとに分割し、過大モデル化を避ける。

### 2. トラストバウンダリを明示

- 外部境界、内部境界、管理境界を分けて記述する。
- 境界を跨ぐデータフローは優先レビュー対象にする。

### 3. 対策ステータスを運用化

- 脅威ごとに担当者と期限を設定する。
- Not Applicable は根拠を残して監査可能にする。

## 公式ドキュメント

- ダウンロード: https://aka.ms/threatmodelingtool
- ドキュメント: https://learn.microsoft.com/azure/security/develop/threat-modeling-tool
- GitHub: https://github.com/microsoft/threat-modeling-tool
- SDL: https://www.microsoft.com/securityengineering/sdl

## まとめ

1. ** 体系分析 ** : DFD と STRIDE で設計段階の脅威を体系的に洗い出しやすい。
2. ** 事前合意 ** : 優先度付きの対策管理により、実装前のセキュリティ合意を進めやすい。
3. ** 継続運用 ** : モデル粒度と運用ルールを決めることで、継続的な脅威分析を回しやすい。
