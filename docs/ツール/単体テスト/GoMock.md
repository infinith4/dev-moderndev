# GoMock

## 概要
GoMock は Go 向けのモック生成ライブラリです。インターフェースを基にテスト用モックを作成し、外部依存を切り離した単体テストを実現します。

## 料金
| プラン | 料金 | 備考 |
|---|---:|---|
| OSS | 無料 | Go プロジェクトで広く利用可能 |

## 主な特徴
| 特徴 | 内容 |
|---|---|
| モック生成 | インターフェースからモックを生成できる |
| 呼び出し検証 | 期待された呼び出し回数や順序を確認できる |
| Go 親和性 | 標準 testing と組み合わせやすい |

## 主な機能

### コア機能

| 機能 | 用途 | 実務での使いどころ |
|---|---|---|
| 依存置換 | 外部 API や DB を隔離 | 不安定要因の除去 |
| 期待値検証 | 呼び出し契約の確認 | サービス層の品質担保 |
| 自動生成 | モック保守効率化 | インターフェース変更追従 |

### 連携機能

| 機能 | 説明 |
|------|------|
| ツール連携 | 既存の開発・運用ツールと連携しやすい |
| 自動実行 | ローカル実行と CI 実行の両方に対応しやすい |

### 運用機能

| 機能 | 説明 |
|------|------|
| 結果管理 | 実行結果を蓄積して比較しやすい |
| 変更追跡 | 設定変更の影響を確認しやすい |

## インストールとセットアップ

公式URL:
- [公式リンク1](https://github.com/golang/mock)

セットアップ手順:
1. プロジェクトで採用するモック方針を決めます。
2. モック生成対象インターフェースを整理します。
3. テスト実行時にモックを参照する運用を整備します。

## 基本的な使い方
1. 外部依存をインターフェースとして抽象化します。
2. テストではモックへ期待挙動を設定します。
3. 実行結果で戻り値と呼び出し契約を検証します。

最小実行例:
- ローカル環境で GoMock の基本機能を実行
- CI で定期実行し、結果を比較

## メリット
| 観点 | 内容 |
|---|---|
| 再現性 | 外部要因を除いて安定実行できる |
| 品質 | 契約違反を早期に検知できる |
| 保守性 | モック生成で手書き負荷を減らせる |

## デメリット
| 観点 | 内容 |
|---|---|
| 複雑化 | 期待設定が増えると読みにくくなる |
| 過剰利用 | 実装詳細に依存した脆いテストになりやすい |
| 運用負荷 | インターフェース変更時の追従が必要 |

## 他ツールとの比較
| ツール | 強み | 使い分け |
|---|---|---|
| GoMock | 生成ベースの厳密検証 | 契約検証重視 |
| Testify/mock | 記述が比較的簡潔 | 開発速度重視 |
| 手書きスタブ | 小規模で柔軟 | 簡単な依存のみ |

## ベストプラクティス
1. 重要な依存だけをモック化し、過剰な抽象化を避けます。
2. 挙動より契約（入力・出力・副作用）を中心に検証します。
3. 失敗時に原因が読めるテスト名とケース構成にします。

## 公式ドキュメント
- https://github.com/golang/mock

## まとめ

1. ** 再現性 ** : GoMock は外部依存を切り離した安定的な単体テストに有効です。
2. ** 設計品質 ** : 効果を出すには、モック対象の選定と契約中心の検証設計が重要です。
3. ** 保守性 ** : 過度な期待値設定は保守性を下げるため、粒度管理が必要です。

