# Apache NiFi

## 概要
Apache NiFi は、データフローの収集・変換・配送を視覚的に設計できるデータ連携ツールです。リアルタイム連携や多様なシステム間の受け渡し制御に適しています。

## 料金
| プラン | 料金 | 備考 |
|---|---:|---|
| OSS | 無料 | 自前運用が前提 |
| 商用サポート/配布版 | 有料 | 監視・運用機能が強化される場合あり |

## 主な特徴
| 特徴 | 内容 |
|---|---|
| フロー設計 UI | ノード接続で処理を可視化できる |
| 多様な接続先 | DB、メッセージング、HTTP などに対応 |
| 制御機能 | キュー、優先度、再試行、バックプレッシャーを管理できる |

## 主な機能

### コア機能

| 機能 | 用途 | 実務での使いどころ |
|---|---|---|
| データ取り込み | 複数ソースから受信 | 連携基盤の入口統合 |
| 変換処理 | 形式変換・フィルタ | 下流システムへの整形 |
| ルーティング | 条件分岐で配送先制御 | 監査用・業務用の分配 |

### 連携機能

| 機能 | 説明 |
|------|------|
| ツール連携 | 既存の開発・運用ツールと連携しやすい |
| 自動実行 | ローカル実行と CI 実行の両方に対応しやすい |

### 運用機能

| 機能 | 説明 |
|------|------|
| 結果管理 | 実行結果を蓄積して比較しやすい |
| 変更追跡 | 設定変更の影響を確認しやすい |

## インストールとセットアップ

公式URL:
- [公式リンク1](https://nifi.apache.org/)
- [公式リンク2](https://nifi.apache.org/documentation/)

セットアップ手順:
1. 実行環境と接続先一覧を整理します。
2. 認証、暗号化、アクセス制御を先に設計します。
3. 本番前にフロー停止・再開・再処理手順を確認します。

## 基本的な使い方
1. 入力、変換、出力の処理単位でフローを分割します。
2. キュー設定とエラールートを設計します。
3. 運用時は遅延や滞留を監視し、閾値超過時に調整します。

最小実行例:
- ローカル環境で Apache NiFi の基本機能を実行
- CI で定期実行し、結果を比較

## メリット
| 観点 | 内容 |
|---|---|
| 可視性 | データの流れを運用者が把握しやすい |
| 柔軟性 | 連携先追加や処理変更に対応しやすい |
| 信頼性 | 再試行や滞留制御で連携失敗を吸収しやすい |

## デメリット
| 観点 | 内容 |
|---|---|
| 設計依存 | フローが肥大化すると保守が難しくなる |
| 運用負荷 | キュー監視や性能調整の継続運用が必要 |
| 学習コスト | プロセッサ特性と制御概念の理解が必要 |

## 他ツールとの比較
| ツール | 強み | 使い分け |
|---|---|---|
| NiFi | データ流通制御と可視化に強い | システム間連携中心 |
| Airflow | ジョブ依存管理に強い | バッチオーケストレーション中心 |
| Talend 等 ETL | GUI ETL が強力 | 商用機能とサポート重視 |

## ベストプラクティス
1. フローを業務単位で分離し、命名規約を統一します。
2. 失敗ルートと再処理手順を最初に設計します。
3. 連携先 SLA に合わせてキューと並列度を調整します。

## 公式ドキュメント
- https://nifi.apache.org/
- https://nifi.apache.org/documentation/

## まとめ

1. **情報共有** : NiFi はデータ連携の流れを可視化しながら制御できる実運用向けツールです。
2. **導入容易** : 導入時は機能実装より先に、キュー制御と障害時手順の設計が重要です。
3. **保守性** : フローの分割と命名規約を徹底すると長期保守性を高められます。

