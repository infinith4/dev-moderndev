# OWASP ASVS

## 概要

OWASP ASVS（Application Security Verification Standard）は、Webアプリケーションのセキュリティ要件と検証項目を体系化した国際標準フレームワークです。認証、セッション管理、アクセス制御、入力検証、暗号化、エラー処理、API保護等の14カテゴリにわたるセキュリティ要件を定義し、3段階の検証レベルで段階的な適用が可能です。セキュアコーディングのチェックリスト、セキュリティテストの観点、調達要件の定義に活用されます。

## 主な内容

### 1. 検証レベル

| レベル | 対象 | 説明 |
|--------|------|------|
| **Level 1** | すべてのアプリ | 基本的なセキュリティ対策（自動テスト可能な項目中心） |
| **Level 2** | 機密データを扱うアプリ | 大半のアプリに推奨される標準レベル |
| **Level 3** | 高セキュリティアプリ | 金融、医療、重要インフラ等の最高水準 |

### 2. 検証カテゴリ（V1〜V14）

| カテゴリ | 内容 |
|----------|------|
| **V1: アーキテクチャ** | セキュリティアーキテクチャ、脅威モデリング |
| **V2: 認証** | パスワードポリシー、MFA、認証フロー |
| **V3: セッション管理** | セッションID生成、タイムアウト、Cookie属性 |
| **V4: アクセス制御** | RBAC、最小権限、パストラバーサル防止 |
| **V5: 入力検証** | サニタイゼーション、SQLインジェクション、XSS防止 |
| **V6: 暗号化** | TLS設定、パスワードハッシュ、鍵管理 |
| **V7: エラー処理・ログ** | エラーメッセージ制御、セキュリティログ |
| **V8: データ保護** | 機密データの分類、保存、転送時の保護 |
| **V9: 通信** | HTTPS強制、証明書ピンニング |
| **V10: 悪意のあるコード** | サプライチェーンセキュリティ、整合性検証 |
| **V11: ビジネスロジック** | レート制限、ワークフロー改ざん防止 |
| **V12: ファイルとリソース** | ファイルアップロード制限、パス操作防止 |
| **V13: API・Webサービス** | RESTful API、GraphQL、Webhookのセキュリティ |
| **V14: 構成** | HTTPヘッダー、デフォルト設定の変更 |

### 3. 検証要件の例

```
# V2.1.1（認証 - Level 1）
ユーザー設定パスワードの最小長は8文字以上であること

# V3.2.1（セッション管理 - Level 1）
ログアウト時にサーバー側でセッションを無効化すること

# V5.3.4（入力検証 - Level 1）
出力エンコーディングがコンテキスト（HTML/URL/JS/CSS）に応じて適切に行われること

# V6.2.1（暗号化 - Level 2）
パスワードはbcrypt、scrypt、Argon2等の適切なハッシュアルゴリズムで保存すること

# V13.1.1（API - Level 1）
すべてのAPIエンドポイントに認証が要求されること
```

## 利用方法

### セキュリティ要件チェックリストとして

```
1. OWASP ASVS最新版をダウンロード（PDF/Excel/JSON）
2. プロジェクトの対象レベル（L1/L2/L3）を決定
3. 各カテゴリの要件をExcelチェックリストに展開
4. 設計・実装・テスト各フェーズで要件の充足を確認
5. 未対応項目のリスク評価と対応計画を策定
```

### セキュリティテストの観点として

```
1. V2（認証）: パスワード強度テスト、ブルートフォース対策確認
2. V3（セッション）: セッション固定化攻撃テスト、Cookie属性確認
3. V4（アクセス制御）: 権限昇格テスト、IDOR（Insecure Direct Object Reference）チェック
4. V5（入力検証）: SQLインジェクション、XSSの自動スキャン
5. V13（API）: APIエンドポイントの認証・認可テスト
```

### 自動チェックツールとの対応

| ASVS カテゴリ | 自動チェックツール |
|---------------|-------------------|
| V5: 入力検証 | OWASP ZAP、Burp Suite（DAST） |
| V6: 暗号化 | SSL Labs、testssl.sh |
| V10: 悪意のあるコード | OWASP Dependency-Check、Trivy（SCA） |
| V14: 構成 | Mozilla Observatory、SecurityHeaders.com |

### 調達・RFP要件として

```
# RFPセキュリティ要件の記載例
本システムは OWASP ASVS v4.0 Level 2 の要件を満たすこと。
特に以下のカテゴリについては Level 3 相当の対策を実施すること：
- V2: 認証（多要素認証の実装）
- V6: 暗号化（TLS 1.3以上の使用）
- V8: データ保護（個人情報の暗号化保存）
```

## エディション・料金

| エディション | 価格 | 特徴 |
|-------------|------|------|
| **OWASP ASVS** | 無料 | CC BY-SA 4.0 License |

## メリット

1. **体系的**: 14カテゴリでWebアプリのセキュリティ要件を網羅的にカバー
2. **段階的適用**: Level 1〜3で段階的に適用レベルを引き上げ可能
3. **チェックリスト**: Excel/JSONでダウンロードし、そのままプロジェクトで使用可能
4. **国際標準**: OWASPの旗艦プロジェクトとして国際的に認知
5. **調達活用**: セキュリティ要件の定義や委託先への要件提示に利用可能
6. **ツール連携**: DAST/SAST/SCAツールの検証観点として活用可能

## デメリット

1. **項目数が多い**: Level 2で286項目以上あり、全項目の検証は工数が大きい
2. **自動検証不可**: 多くの項目は手動レビューやアーキテクチャ分析が必要
3. **更新頻度**: 最新の脅威に対する追従に時間がかかる場合がある
4. **英語ベース**: 公式は英語のみ（日本語翻訳はコミュニティ版）
5. **汎用的**: プロジェクト固有の要件には追加のカスタマイズが必要

## 代替ツール

| ツール | 特徴 | 比較 |
|--------|------|------|
| **OWASP Top 10** | 主要脆弱性リスト | ASVSよりコンパクト、啓蒙向け |
| **NIST SP 800-53** | 米国政府セキュリティ管理策 | ASVSより広範だが重厚 |
| **CIS Controls** | セキュリティベストプラクティス | ASVSよりインフラ寄り |
| **PCI DSS** | カード業界セキュリティ標準 | 決済系に特化 |

## 公式リンク

- **公式サイト**: [https://owasp.org/www-project-application-security-verification-standard/](https://owasp.org/www-project-application-security-verification-standard/)
- **GitHub**: [https://github.com/OWASP/ASVS](https://github.com/OWASP/ASVS)
- **最新版ダウンロード**: [https://github.com/OWASP/ASVS/releases](https://github.com/OWASP/ASVS/releases)
- **日本語翻訳**: [https://github.com/owasp-ja/asvs-ja](https://github.com/owasp-ja/asvs-ja)

## 関連ドキュメント

- [OWASP Top 10](./OWASP_Top_10.md)
- [OWASP Dependency-Check](../セキュリティ/OWASP_Dependency_Check.md)
- [Trivy](../セキュリティ/Trivy.md)

---

**カテゴリ**: 標準ガイドライン
**対象工程**: 要件定義・設計・実装・テスト
**最終更新**: 2025年12月
**ドキュメントバージョン**: 1.0
