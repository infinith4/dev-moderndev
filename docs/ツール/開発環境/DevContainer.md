# Dev Container

## 概要

Dev Container はコンテナを使って開発環境を定義・共有する仕組みである。ローカル環境差異を減らし、チーム全体で同じ依存関係・ツール群を再現しやすくする。

## 料金

| 区分 | 内容 |
|------|------|
| 仕様/ツール本体 | 無料（OSS ベース） |
| 補足 | Docker 実行環境やクラウド開発環境の費用は別途 |

## 主な特徴

| 項目 | 内容 |
|------|------|
| 環境再現性 | 開発環境をコードで定義 |
| オンボーディング短縮 | 新規参加者が素早く同一環境を構築可能 |
| ツール統一 | IDE 拡張や依存関係を共通化 |
| マルチ言語対応 | 言語/フレームワークを問わず利用可能 |
| CI との整合 | ローカルと実行環境差を縮小しやすい |

## 主な機能

### 環境定義機能

| 機能 | 説明 |
|------|------|
| `devcontainer.json` | エディタ設定・拡張・起動処理を定義 |
| Dockerfile 連携 | 依存ツールを明示的に構築 |
| Compose 連携 | 複数サービス環境を構築 |
| Feature 追加 | よく使う開発ツールを追加 |

### 開発支援機能

| 機能 | 説明 |
|------|------|
| VS Code 連携 | コンテナ内で編集・実行 |
| ポート転送 | アプリ疎通をローカルで確認 |
| ボリューム利用 | ソースコードを即時反映 |
| Post-create 実行 | 初期セットアップ自動化 |

### 運用機能

| 機能 | 説明 |
|------|------|
| バージョン固定 | ツール差異を抑制 |
| 設定共有 | リポジトリで管理しレビュー可能 |
| セキュリティ分離 | ホスト汚染を減らしやすい |
| トラブル切り分け | 環境問題の再現が容易 |

## インストールとセットアップ

公式URL:
- [Dev Containers 公式](https://containers.dev/)
- [VS Code Dev Containers](https://code.visualstudio.com/docs/devcontainers/containers)

セットアップ手順:
1. Docker と対応 IDE 拡張をインストールする。
2. `devcontainer.json` と必要な Docker 定義を作成する。
3. コンテナ再構築を実行し、依存ツール導入を確認する。

## 基本的な使い方

1. リポジトリに環境定義ファイルを配置する。
2. 「Reopen in Container」で開発環境を起動する。
3. 初回起動時の依存導入が正常終了することを確認する。
4. 以後はローカル差異を作らずコンテナ内で作業する。

最小コマンド:
- 参考: `docker compose up -d`（Compose 構成時）

## メリット

- 環境差異を大幅に減らせる
- 初期構築手順を標準化できる
- 開発体験をチームで揃えやすい
- 再現性の高いトラブルシュートが可能

## デメリット

- Docker 前提のため初期学習コストがある
- リソース消費が増える場合がある
- 既存ローカルワークフローとの調整が必要

## 他ツールとの比較

| ツール | 主な用途 | 特徴 |
|------|------|------|
| Dev Container | 開発環境再現 | エディタ統合で運用しやすい |
| Vagrant | VM 環境構築 | フル VM ベースで重め |
| Nix | 再現環境管理 | 厳密な依存固定に強い |
| Docker Compose 単体 | サービス起動 | 開発体験統合は手動設計が必要 |

## ベストプラクティス

### 1. 最小構成で開始

- 必要最小限の依存のみ定義する
- 過剰機能を避けて起動時間を抑える

### 2. 設定をレビュー対象にする

- 環境変更は Pull Request で管理する
- 影響範囲をチームで確認する

### 3. 起動検証を定期実施

- クリーン環境で再構築テストを行う
- 壊れたセットアップ手順を早期検出する

## 公式ドキュメント

- 仕様: https://containers.dev/
- VS Code ドキュメント: https://code.visualstudio.com/docs/devcontainers/containers
- リファレンス: https://containers.dev/implementors/json_reference/

## まとめ

1. **環境統一** : Dev Container は開発環境差異の解消に有効。
2. **コード管理** : 環境をコード管理すると再現性と保守性が上がる。
3. **安定運用** : 最小構成と定期再構築検証が安定運用の鍵。
